---
import Layout from "../layouts/Layout.astro";
import CVHeader from "../components/CVHeader.astro";
import CVSection from "../components/CVSection.astro";
import ExperienceItem from "../components/ExperienceItem.astro";
import EducationItem from "../components/EducationItem.astro";
import PublicationItem from "../components/PublicationItem.astro";
import SkillsSection from "../components/SkillsSection.astro";
import cvData from "../data/cv-data.json";
import type { CVData } from "../types/cv-types";

const data: CVData = cvData as CVData;
---

<Layout title="Currículum Vitae">
  <div class="min-h-screen py-8 px-4 bg-blue-50">
    <div class="max-w-4xl mx-auto bg-white shadow-lg rounded-lg p-4 sm:p-8">
      <!-- Header con información personal -->
      <CVHeader
        name={data.personalInfo.name}
        title={data.personalInfo.title}
        email={data.personalInfo.email}
        phone={data.personalInfo.phone}
        location={data.personalInfo.location}
        linkedin={data.personalInfo.linkedin}
        github={data.personalInfo.github}
        website={data.personalInfo.website}
        diplomas={data.personalInfo.diplomas}
      />

      <!-- Resumen Profesional -->
      <CVSection title="Resumen Profesional">
        <p class="text-gray-700 leading-relaxed text-justify">
          {data.summary}
        </p>
      </CVSection>

      <!-- Experiencia Laboral -->
      <CVSection title="Experiencia Laboral">
        {
          data.experience.map((exp) => (
            <ExperienceItem
              position={exp.position}
              company={exp.company}
              period={exp.period}
              location={exp.location}
              description={exp.description}
              technologies={exp.technologies}
            />
          ))
        }
      </CVSection>

      <!-- Educación -->
      <CVSection title="Educación">
        {
          data.education.map((edu) => (
            <EducationItem
              degree={edu.degree}
              institution={edu.institution}
              period={edu.period}
              location={edu.location}
              gpa={edu.gpa}
              achievements={edu.achievements}
            />
          ))
        }
      </CVSection>

      <!-- Habilidades -->
      <CVSection title="Habilidades Técnicas">
        <SkillsSection categories={data.skills.categories} />
      </CVSection>

      <!-- Publicaciones -->
      <CVSection title="Publicaciones">
        {
          data.publications.map((pub) => (
            <PublicationItem
              title={pub.title}
              authors={pub.authors}
              publication={pub.publication}
              date={pub.date}
              doi={pub.doi}
              link={pub.link}
              description={pub.description}
            />
          ))
        }
      </CVSection>

      <!-- Competencias -->
      <CVSection title="Competencias">
        <div class="space-y-3">
          {
            data.competitions.map((comp) => (
              <div class="flex justify-between items-center p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-lg hover:shadow-md transition-shadow">
                <div>
                  <h4 class="font-semibold text-gray-900">{comp.title}</h4>
                  <p class="text-sm text-gray-600">{comp.platform}</p>
                  <p class="text-xs text-gray-500 mt-1">{comp.description}</p>
                </div>
                <div class="text-right">
                  <span class="inline-block px-3 py-1 text-sm font-medium text-blue-800 bg-blue-100 rounded-full">
                    {comp.position}
                  </span>
                </div>
              </div>
            ))
          }
        </div>
      </CVSection>

      <!-- Certificaciones -->
      <CVSection title="Certificaciones">
        <div class="space-y-3">
          {
            data.certifications.map((cert) => (
              <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                <div>
                  <h4 class="font-semibold text-gray-900">{cert.name}</h4>
                  <p class="text-sm text-gray-600">{cert.issuer}</p>
                </div>
                <span class="text-sm text-gray-500">{cert.year}</span>
              </div>
            ))
          }
        </div>
      </CVSection>

      <!-- Idiomas -->
      <CVSection title="Idiomas">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          {
            data.languages.map((lang) => (
              <div class="text-center p-4 bg-gray-50 rounded-lg">
                <h4 class="font-semibold text-gray-900">{lang.name}</h4>
                <p class="text-sm text-gray-600">{lang.level}</p>
              </div>
            ))
          }
        </div>
      </CVSection>
    </div>
  </div>
</Layout>
