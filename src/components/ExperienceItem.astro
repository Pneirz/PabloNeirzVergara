---
export interface Props {
  position: string;
  company: string;
  period: string;
  location?: string;
  description: string[];
  technologies?: string[];
  id?: string;
}

const { position, company, period, location, description, technologies, id } = Astro.props;

// Function to convert markdown links to HTML
function processMarkdownLinks(text: string): string {
  return text.replace(
    /\[([^\]]+)\]\(([^)]+)\)/g,
    '<a href="$2" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800 underline">$1</a>',
  );
}
---

<ol class="timeline">
  <li id={id} class="timeline-item">
    <span class="size-3 shrink-0 rounded-full bg-blue-600"></span>
    <div class="flex-grow">
      <div class="mb-2 flex flex-col md:flex-row md:items-start md:justify-between">
        <div>
          <h4 class="text-lg font-semibold text-gray-900">{position}</h4>
          <h5 class="text-md font-medium text-blue-600">{company}</h5>
          {location && <p class="text-sm text-gray-500">{location}</p>}
        </div>
        <span class="text-sm font-medium text-gray-500 md:text-right">{period}</span>
      </div>

      <ul class="mb-3 list-inside list-disc space-y-1 text-gray-700">
        {
          description.map((item) => (
            <li class="text-sm leading-relaxed" set:html={processMarkdownLinks(item)} />
          ))
        }
      </ul>

      {
        technologies && technologies.length > 0 && (
          <div class="flex flex-wrap gap-2">
            {technologies.map((tech) => (
              <span class="pill">{tech}</span>
            ))}
          </div>
        )
      }
    </div>
  </li>
</ol>
